parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Xu3H":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=function(){function e(i,n,u){t(this,e),this.x=i||0,this.y=n||0,this.z=u||0}return i(e,[{key:"vec",get:function(){return[this.x,this.y,this.z]},set:function(t){this.x=t[0],this.y=t[1],this.z=t[2]}},{key:"zero",value:function(){return this.x=this.y=this.z=0,this}},{key:"unit",value:function(){return this.x=this.y=this.z=1,this}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"mult",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"div",value:function(t){return 0===t?this:(this.x/=t,this.y/=t,this.z/=t,this)}},{key:"sizeSqr",value:function(){return Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2)}},{key:"size",value:function(){return Math.sqrt(this.sizeSqr())}},{key:"distSqr",value:function(t){return e.sub(this,t).sizeSqr()}},{key:"dist",value:function(t){return e.sub(this,t).size()}},{key:"normalise",value:function(){return this.div(this.size()||1)}},{key:"limit",value:function(t){return this.size()>t&&this.normalise().mult(t),this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"cross",value:function(t){var e,i,n;return e=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,n=this.x*t.y-this.y*t.x,this.x=e,this.y=i,this.z=n,this}},{key:"transformMat4",value:function(t){var e=this.x,i=this.y,n=this.z,u=t[3]*e+t[7]*i+t[11]*n+t[15];return u=u||1,this.x=(t[0]*e+t[4]*i+t[8]*n+t[12])/u,this.y=(t[1]*e+t[5]*i+t[9]*n+t[13])/u,this.z=(t[2]*e+t[6]*i+t[10]*n+t[14])/u,this}}],[{key:"zero",value:function(){return new e(0,0,0)}},{key:"unit",value:function(){return new e(1,1,1)}},{key:"clone",value:function(t){return new e(t.x,t.y,t.z)}},{key:"copy",value:function(t){return(new e).copy(t)}},{key:"add",value:function(t,i){return new e(t.x+i.x,t.y+i.y,t.z+i.z)}},{key:"sub",value:function(t,i){return new e(t.x-i.x,t.y-i.y,t.z-i.z)}},{key:"mulit",value:function(t,i){return new e(t.x*i,t.y*i,t.z*i)}},{key:"div",value:function(t,i){return 0===i?t:new e(t.x/i,t.y/i,t.z/i)}},{key:"normalise",value:function(t){return e.div(t,t.size()||1)}},{key:"limit",value:function(t,i){return t.size()>i?e.normalise(t).mult(i):t}},{key:"cross",value:function(t,i){return e.copy(t).cross(i)}},{key:"transformMat4",value:function(t,i){return e.copy(t).transformMat4(i)}}]),e}();exports.default=n;
},{}],"og34":[function(require,module,exports) {
"use strict";function t(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function a(t,a){for(var i=0;i<a.length;i++){var s=a[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function i(t,i,s){return i&&a(t.prototype,i),s&&a(t,s),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var s=function(){function a(i){t(this,a),Array.isArray(i)&&16===i.length?this.mat=new Float32Array(i):(this.mat=new Float32Array(16),this.mat[0]=this.mat[5]=this.mat[10]=this.mat[15]=1)}return i(a,[{key:"elements",get:function(){return this.mat},set:function(t){Array.isArray(t)&&16===t.length&&(this.mat=t)}},{key:"identity",value:function(){return this.mat=new Float32Array(16),this.mat[0]=this.mat[5]=this.mat[10]=this.mat[15]=1,this}},{key:"copy",value:function(t){return this.mat=new Float32Array(t.mat),this}},{key:"orthographic",value:function(t,a,i,s,h,m){var e=1/(s-a),r=1/(i-t),n=1/(h-m);return this.mat[0]=-2*e,this.mat[1]=0,this.mat[2]=0,this.mat[3]=0,this.mat[4]=0,this.mat[5]=-2*r,this.mat[6]=0,this.mat[7]=0,this.mat[8]=0,this.mat[9]=0,this.mat[10]=2*n,this.mat[11]=0,this.mat[12]=(s+a)*e,this.mat[13]=(t+i)*r,this.mat[14]=(m+h)*n,this.mat[15]=1,this}},{key:"perspective",value:function(t,a,i,s){var h,m=1/Math.tan(t/2);return this.mat[0]=m/a,this.mat[1]=0,this.mat[2]=0,this.mat[3]=0,this.mat[4]=0,this.mat[5]=m,this.mat[6]=0,this.mat[7]=0,this.mat[8]=0,this.mat[9]=0,this.mat[11]=-1,this.mat[12]=0,this.mat[13]=0,this.mat[15]=0,null!=s&&s!==1/0?(h=1/(i-s),this.mat[10]=(s+i)*h,this.mat[14]=2*s*i*h):(this.mat[10]=-1,this.mat[14]=-2*i),this}},{key:"transpose",value:function(){var t=this.mat[1],a=this.mat[2],i=this.mat[3],s=this.mat[6],h=this.mat[7],m=this.mat[11];return this.mat[1]=this.mat[4],this.mat[2]=this.mat[8],this.mat[3]=this.mat[12],this.mat[4]=t,this.mat[6]=this.mat[9],this.mat[7]=this.mat[13],this.mat[8]=a,this.mat[9]=s,this.mat[11]=this.mat[14],this.mat[12]=i,this.mat[13]=h,this.mat[14]=m,this}},{key:"invert",value:function(){var t=this.mat[0],a=this.mat[1],i=this.mat[2],s=this.mat[3],h=this.mat[4],m=this.mat[5],e=this.mat[6],r=this.mat[7],n=this.mat[8],u=this.mat[9],o=this.mat[10],c=this.mat[11],l=this.mat[12],y=this.mat[13],v=this.mat[14],f=this.mat[15],p=t*m-a*h,k=t*e-i*h,M=t*r-s*h,w=a*e-i*m,A=a*r-s*m,d=i*r-s*e,g=n*y-u*l,b=n*v-o*l,F=n*f-c*l,q=u*v-o*y,x=u*f-c*y,X=o*f-c*v,Y=p*X-k*x+M*q+w*F-A*b+d*g;return Y?(Y=1/Y,this.mat[0]=(m*X-e*x+r*q)*Y,this.mat[1]=(i*x-a*X-s*q)*Y,this.mat[2]=(y*d-v*A+f*w)*Y,this.mat[3]=(o*A-u*d-c*w)*Y,this.mat[4]=(e*F-h*X-r*b)*Y,this.mat[5]=(t*X-i*F+s*b)*Y,this.mat[6]=(v*M-l*d-f*k)*Y,this.mat[7]=(n*d-o*M+c*k)*Y,this.mat[8]=(h*x-m*F+r*g)*Y,this.mat[9]=(a*F-t*x-s*g)*Y,this.mat[10]=(l*A-y*M+f*p)*Y,this.mat[11]=(u*M-n*A-c*p)*Y,this.mat[12]=(m*b-h*q-e*g)*Y,this.mat[13]=(t*q-a*b+i*g)*Y,this.mat[14]=(y*k-l*w-v*p)*Y,this.mat[15]=(n*w-u*k+o*p)*Y,this):null}},{key:"translate",value:function(t){var a=t[0],i=t[1],s=t[2];return this.mat[12]=this.mat[0]*a+this.mat[4]*i+this.mat[8]*s+this.mat[12],this.mat[13]=this.mat[1]*a+this.mat[5]*i+this.mat[9]*s+this.mat[13],this.mat[14]=this.mat[2]*a+this.mat[6]*i+this.mat[10]*s+this.mat[14],this.mat[15]=this.mat[3]*a+this.mat[7]*i+this.mat[11]*s+this.mat[15],this}},{key:"multiply",value:function(t){var a=this.mat[0],i=this.mat[1],s=this.mat[2],h=this.mat[3],m=this.mat[4],e=this.mat[5],r=this.mat[6],n=this.mat[7],u=this.mat[8],o=this.mat[9],c=this.mat[10],l=this.mat[11],y=this.mat[12],v=this.mat[13],f=this.mat[14],p=this.mat[15],k=t.mat[0],M=t.mat[1],w=t.mat[2],A=t.mat[3];return this.mat[0]=k*a+M*m+w*u+A*y,this.mat[1]=k*i+M*e+w*o+A*v,this.mat[2]=k*s+M*r+w*c+A*f,this.mat[3]=k*h+M*n+w*l+A*p,k=t.mat[4],M=t.mat[5],w=t.mat[6],A=t.mat[7],this.mat[4]=k*a+M*m+w*u+A*y,this.mat[5]=k*i+M*e+w*o+A*v,this.mat[6]=k*s+M*r+w*c+A*f,this.mat[7]=k*h+M*n+w*l+A*p,k=t.mat[8],M=t.mat[9],w=t.mat[10],A=t.mat[11],this.mat[8]=k*a+M*m+w*u+A*y,this.mat[9]=k*i+M*e+w*o+A*v,this.mat[10]=k*s+M*r+w*c+A*f,this.mat[11]=k*h+M*n+w*l+A*p,k=t.mat[12],M=t.mat[13],w=t.mat[14],A=t.mat[15],this.mat[12]=k*a+M*m+w*u+A*y,this.mat[13]=k*i+M*e+w*o+A*v,this.mat[14]=k*s+M*r+w*c+A*f,this.mat[15]=k*h+M*n+w*l+A*p,this}},{key:"lookAt",value:function(t,a,i){var s=t[0],h=t[1],m=t[2],e=i[0],r=i[1],n=i[2],u=s-a[0],o=h-a[1],c=m-a[2],l=u*u+o*o+c*c;l>0&&(u*=l=1/Math.sqrt(l),o*=l,c*=l);var y=r*c-n*o,v=n*u-e*c,f=e*o-r*u;return(l=y*y+v*v+f*f)>0&&(y*=l=1/Math.sqrt(l),v*=l,f*=l),this.mat[0]=y,this.mat[1]=v,this.mat[2]=f,this.mat[3]=0,this.mat[4]=o*f-c*v,this.mat[5]=c*y-u*f,this.mat[6]=u*v-o*y,this.mat[7]=0,this.mat[8]=u,this.mat[9]=o,this.mat[10]=c,this.mat[11]=0,this.mat[12]=s,this.mat[13]=h,this.mat[14]=m,this.mat[15]=1,this}},{key:"rotateX",value:function(t){var a=Math.sin(t),i=Math.cos(t),s=this.mat[4],h=this.mat[5],m=this.mat[6],e=this.mat[7],r=this.mat[8],n=this.mat[9],u=this.mat[10],o=this.mat[11];return this.mat[4]=s*i+r*a,this.mat[5]=h*i+n*a,this.mat[6]=m*i+u*a,this.mat[7]=e*i+o*a,this.mat[8]=r*i-s*a,this.mat[9]=n*i-h*a,this.mat[10]=u*i-m*a,this.mat[11]=o*i-e*a,this}},{key:"rotateY",value:function(t){var a=Math.sin(t),i=Math.cos(t),s=this.mat[0],h=this.mat[1],m=this.mat[2],e=this.mat[3],r=this.mat[8],n=this.mat[9],u=this.mat[10],o=this.mat[11];return this.mat[0]=s*i-r*a,this.mat[1]=h*i-n*a,this.mat[2]=m*i-u*a,this.mat[3]=e*i-o*a,this.mat[8]=s*a+r*i,this.mat[9]=h*a+n*i,this.mat[10]=m*a+u*i,this.mat[11]=e*a+o*i,this}},{key:"rotateZ",value:function(t){var a=Math.sin(t),i=Math.cos(t),s=this.mat[0],h=this.mat[1],m=this.mat[2],e=this.mat[3],r=this.mat[4],n=this.mat[5],u=this.mat[6],o=this.mat[7];return this.mat[0]=s*i+r*a,this.mat[1]=h*i+n*a,this.mat[2]=m*i+u*a,this.mat[3]=e*i+o*a,this.mat[4]=r*i-s*a,this.mat[5]=n*i-h*a,this.mat[6]=u*i-m*a,this.mat[7]=o*i-e*a,this}},{key:"rotate",value:function(t,a){var i,s,h,m,e,r,n,u,o,c,l,y,v,f,p,k,M,w,A,d,g,b,F,q,x=a[0],X=a[1],Y=a[2],Z=Math.sqrt(x*x+X*X+Y*Y);return x*=Z=1/Z,X*=Z,Y*=Z,i=Math.sin(t),h=1-(s=Math.cos(t)),m=this.mat[0],e=this.mat[1],r=this.mat[2],n=this.mat[3],u=this.mat[4],o=this.mat[5],c=this.mat[6],l=this.mat[7],y=this.mat[8],v=this.mat[9],f=this.mat[10],p=this.mat[11],k=x*x*h+s,M=X*x*h+Y*i,w=Y*x*h-X*i,A=x*X*h-Y*i,d=X*X*h+s,g=Y*X*h+x*i,b=x*Y*h+X*i,F=X*Y*h-x*i,q=Y*Y*h+s,this.mat[0]=m*k+u*M+y*w,this.mat[1]=e*k+o*M+v*w,this.mat[2]=r*k+c*M+f*w,this.mat[3]=n*k+l*M+p*w,this.mat[4]=m*A+u*d+y*g,this.mat[5]=e*A+o*d+v*g,this.mat[6]=r*A+c*d+f*g,this.mat[7]=n*A+l*d+p*g,this.mat[8]=m*b+u*F+y*q,this.mat[9]=e*b+o*F+v*q,this.mat[10]=r*b+c*F+f*q,this.mat[11]=n*b+l*F+p*q,this}}],[{key:"identity",value:function(){return new a}},{key:"copy",value:function(t){return(new a).copy(t)}},{key:"orthographic",value:function(t,i,s,h,m,e){return(new a).orthographic(t,i,s,h,m,e)}},{key:"perspective",value:function(t,i,s,h){return(new a).perspective(t,i,s,h)}},{key:"transpose",value:function(t){return a.copy(t).transpose()}},{key:"invert",value:function(t){return a.copy(t).invert()}},{key:"translate",value:function(t,i){return a.copy(t).translate(i)}},{key:"multiply",value:function(t,i){return a.copy(t).multiply(i)}},{key:"lookAt",value:function(t,i,s){return(new a).lookAt(t,i,s)}},{key:"rotateX",value:function(t,i){return a.copy(t).rotateX(i)}},{key:"rotateY",value:function(t,i){return a.copy(t).rotateY(i)}},{key:"rotateZ",value:function(t,i){return a.copy(t).rotateZ(i)}},{key:"rotate",value:function(t,i){return a.copy(mat).rotate(t,i)}}]),a}();exports.default=s;
},{}],"LO0M":[function(require,module,exports) {
"use strict";function r(){for(var r,t=[],o=[],a=[],e=[],n=.1,s=.4,u=.2,h=2*Math.PI/16,i=Math.PI/8,f=0;f<=8;f++){r=0;for(var M=f*i,c=M/Math.PI,p=Math.sin(M),v=Math.cos(M);r<=16;r++){var x=r*h,l=x/Math.PI/2,y=n*Math.cos(x)*p,d=s*v,P=u*Math.sin(x)*p;o.push(y,P,d),a.push(y,P,d),r>=8&&(l=(16-r)*h/Math.PI/2),e.push(l,c)}}for(f=0;f<8;f++){r=0;for(var w=17*f;r<16;r++){var A=w+r,I=A+16+1;7!==f&&t.push(I,A,I+1),0!==f&&t.push(I+1,A,A+1)}}return{indices:new Uint16Array(t),vertices:new Float32Array(o),normals:new Float32Array(a),uvs:new Float32Array(e),count:t.length}}function t(r){for(var t,o,a=new Uint8Array(r*r*4),e=2,s=2,u={x:4,y:8},h=1;h<=4;h++){var i=r/h;for(o=0,u.x*=h,u.y*=h;o<r;o++){t=0;for(var f=o*r*4;t<r;t++){var M=f+4*t;a[M]=a[M+1]=a[M+2]=a[M+3]=a[M]+Math.floor(n((e+t*u.x)/i,(s+o*u.y)/i)/4*255)}}}return a}function o(r,t){return Math.abs(43758.5453123*Math.sin(a(r,t,12.9898,78.233))%1)}function a(r,t,o,a){return r*o+t*a}function e(r,t,o){return r*(1-o)+t*o}function n(r,t){var a=Math.floor(r),n=Math.floor(t),s=r%1,u=t%1,h=o(a,n),i=o(a+1,n),f=o(a,n+1),M=o(a+1,n+1);return us=s*s*s*(s*(6*s-15)+10),ut=u*u*u*(u*(6*u-15)+10),e(h,i,us)+(f-h)*ut*(1-us)+(M-i)*us*ut}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSphereGeo=r,exports.noiseGrid=t,exports.random=o,exports.dot=a,exports.mix=e,exports.noise=n;
},{}],"hAMr":[function(require,module,exports) {
"use strict";function r(r,t){for(var o=new Uint8Array(r*t*4),a=[],e=0,i=0;e<256;e++)a.push({x:Math.floor(Math.random()*r),y:Math.floor(Math.random()*t)});for(;i<t;i++){e=0;for(var u=i*r*4;e<r;e++){var f=u+4*e;o[f]=o[f+1]=o[f+2]=o[f+3]=n(r,t,e,i,a)}}return{image:o,width:r,height:t}}function t(r,t,o,n,e){for(var i=r*t,u=0,f=e.length;u<f;u++){if(o===e[u].x&&n===e[u].y)return 255;var h=a(o,n,e[u].x,e[u].y);h<=i&&(i=h,e[u])}return 4*i>255?0:255-4*i}function o(r,t,o,n,e){for(var i=r*t,u=0,f=e.length;u<f;u++){if(o===e[u].x&&n===e[u].y)return 255;var h=Math.floor(a(o,n,e[u].x,e[u].y));if(h===i||h===i+1||h===i-1)return 255;h<i&&(i=h,e[u])}return 0}function n(r,t,o,n,e){for(var u,f=r/32,h=t/16,s=a(0,0,2,2),x=o/f,M=n/h,p=Math.floor(x),v=Math.floor(M),y=x%1,c=M%1,d=s,l=-1;l<=1;l++)for(u=-1;u<=1;u++){var m=i(p+u,v+l);(v+l)%2==0?(m.x=0+.2*m.x,m.y=.5+.5*m.y):(m.x=.5+.2*m.x,m.y=.5+.5*m.y);var w=a(y,c,m.x+u,m.y+l);w<=d&&(d=w)}return 255-(d=Math.pow(d,2)/.64*255)}function a(r,t,o,n){return Math.sqrt(Math.pow(r-o,2)+Math.pow(t-n,2))}function e(r,t){return Math.abs(43758.5453123*Math.sin(u(r,t,12.9898,78.233))%1)}function i(r,t){return{x:Math.abs(43758.5453123*Math.sin(u(r,t,12.9898,78.233))%1),y:Math.abs(27045.238539*Math.sin(u(r,t,34.6794,23.978))%1)}}function u(r,t,o,n){return r*o+t*n}function f(r,t,o){return r*(1-o)+t*o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.voronoiPattern=r,exports.voronoiNoise=t,exports.voronoiBoundry=o,exports.voronoiGrid=n,exports.distance=a,exports.random=e,exports.random2=i,exports.dot=u,exports.mix=f;
},{}],"RkSw":[function(require,module,exports) {
"use strict";function n(n){return a(n)||o(n)||t(n)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function t(n,e){if(n){if("string"==typeof n)return r(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(n,e):void 0}}function o(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function a(n){if(Array.isArray(n))return r(n)}function r(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}function c(){return"#version 300 es\n        precision mediump float;\n\n        layout (location = 0) in vec2 aTexIndex;\n        layout (location = 1) in vec3 aVerts;\n        layout (location = 2) in vec3 aNorm;\n        layout (location = 3) in vec2 aUV;\n\n        uniform sampler2D uPos;\n        uniform sampler2D uVel;\n\n        uniform mat4 uWorldViewProjection;\n        uniform mat4 uWorld;\n        uniform mat4 uNormal;\n        uniform mat4 uLightSpaceMatrix;\n\n        out vec3 vFragPos;\n        out vec3 vNormal;\n        out vec3 vCol;\n        out vec2 vUV;\n        out vec3 vFragPosLightSpace;\n\n        mat4 lookAt(vec3 pos, vec3 target, vec3 up);\n        mat4 rotZ(float a);\n        mat4 scale(vec3 s);\n\n        void main() {\n            vec4 pos = vec4(texelFetch(uPos, ivec2(aTexIndex), 0).xyz, 1.0);\n            vec4 vel = vec4(texelFetch(uVel, ivec2(aTexIndex), 0).xyz, 1.0);\n\n            mat4 rot = lookAt(vec3(0.0), vel.xyz, vec3(0.0, 1.0, 0.0));\n            mat4 bank = rotZ(dot(vel.xz, vec2(0.0, 1.0)) * 0.2);\n\n            vec4 vert = rot * bank * vec4(aVerts, 1.0);\n            vec4 norm = rot * bank * vec4(aNorm, 1.0);\n\n            vCol = vec3(0.5) + mix(normalize(pos.xyz), normalize(vel.xyz), 0.5) * 0.7 + texelFetch(uVel, ivec2(aTexIndex), 0).w;\n\n            if (texelFetch(uPos, ivec2(aTexIndex), 0).w == 1.0) {\n                vert = scale(vec3(2.0)) * vert;\n                vCol = vec3(0.0, 0.8, 1.2);\n            }\n\n            vec4 vertPos = vert + pos;\n\n            vFragPos = (uWorld * vertPos).xyz;\n            vNormal = (uNormal * norm).xyz;\n            vUV = aUV;\n            vFragPosLightSpace = (uLightSpaceMatrix * vertPos).xyz;\n\n            gl_Position = uWorldViewProjection * vertPos;\n        }\n\n        mat4 lookAt(vec3 pos, vec3 target, vec3 up) {\n            vec3 z = normalize(target - pos);\n            vec3 x = normalize(cross(up, z));\n            vec3 y = cross(z, x);\n\n            return mat4(\n                x.x, x.y, x.z, 0,\n                y.x, y.y, y.z, 0,\n                z.x, z.y, z.z, 0,\n                0,   0,   0,   1\n            );\n        }\n\n        mat4 rotZ(float a) {\n            float c = cos(a);\n            float s = sin(a);\n            return mat4(\n                c, -s, 0, 0,\n                s,  c, 0, 0,\n                0,  0, 1, 0,\n                0,  0, 0, 1\n            );\n        }\n\n        mat4 scale(vec3 s) {\n            return mat4 (\n                s.x, 0,   0,   0,\n                0,   s.y, 0,   0,\n                0,   0,   s.z, 0,\n                0,   0,   0,   1\n            );\n        }\n    "}function i(){return"#version 300 es\n        precision mediump float;\n\n        in vec3 vFragPos;\n        in vec3 vNormal;\n        in vec3 vCol;\n        in vec2 vUV;\n        in vec3 vFragPosLightSpace;\n\n        uniform vec3 uViewPos;\n        uniform sampler2D uTexture;\n        uniform sampler2D uShadow;\n\n        out vec4 outColor;\n\n        struct Material {\n            vec3 ambient;\n            vec3 diffuse;\n            vec3 specular;\n            float shininess;\n        }\n            a = Material(\n                vec3(1.0, 1.0, 1.0),\n                vec3(1.0, 1.0, 1.0),\n                vec3(1.0, 1.0, 1.0),\n                32.0\n            );\n\n        struct LightDirectional {\n            vec3 direction;\n            vec3 ambient;\n            vec3 diffuse;\n            vec3 specular;\n        }\n            dirLight = LightDirectional (\n                vec3(1.0, -1.0, -1.0),\n                vec3(0.6),\n                vec3(0.6),\n                vec3(0.5)\n            );\n\n        vec3 CalcDirLight(LightDirectional light, vec3 normal, vec3 viewDir, Material material);\n        float ShadowCalculation(vec3 fragPosLightSpace);\n\n        void main() {\n            vec3 texelColor = texture(uTexture, vUV).xyz * vCol;\n\n            a.ambient = texelColor * 0.4;\n            a.diffuse = texelColor * 0.6;\n            a.specular = vec3(0.4) + vCol * 0.1;\n\n            vec3 norm = normalize(vNormal);\n            vec3 viewDir = normalize(uViewPos - vFragPos);\n\n            vec3 result = CalcDirLight(dirLight, norm, viewDir, a) * (1.0 - ShadowCalculation(vFragPosLightSpace));\n\n            outColor = vec4(result, 1.0);\n            outColor.rgb = pow(outColor.rgb, vec3(1.0 / 2.2));\n        }\n\n        vec3 CalcDirLight(LightDirectional light, vec3 normal, vec3 viewDir, Material material) {\n            vec3 lightDir = normalize(-light.direction);\n\n            float diff = max(dot(normal, lightDir), 0.0);\n\n            vec3 halfDir = normalize(lightDir + viewDir);\n            float spec = pow(max(dot(halfDir, normal), 0.0), material.shininess);\n\n            vec3 ambient = light.ambient * material.ambient;\n            vec3 diffuse = light.diffuse * diff * material.diffuse;\n            vec3 specular = light.specular * spec * material.specular;\n\n            return (ambient + diffuse + specular);\n        }\n\n        float ShadowCalculation(vec3 fragPosLightSpace) {\n            vec3 projCoords = fragPosLightSpace.xyz * 0.25 + 0.5;\n            //float closestDepth = texture(uShadow, projCoords.xy).r;\n            //return projCoords.z - 0.005 > closestDepth ? 1.0 : 0.0;\n\n            float shadow = 0.0;\n            vec2 texelSize = 1.0 / vec2(textureSize(uShadow, 0));\n            for(int x = -1; x <= 1; ++x) {\n                for(int y = -1; y <= 1; ++y) {\n                    float pcfDepth = texture(uShadow, projCoords.xy + vec2(x, y) * texelSize).r;\n                    shadow += projCoords.z - 0.005 > pcfDepth ? 1.0 : 0.0;\n                }\n            }\n            return shadow / 12.0;\n        }\n    "}function l(){return"#version 300 es\n        precision mediump float;\n\n        layout (location = 0) in vec3 aPosition;\n\n        void main() {\n            gl_Position = vec4(aPosition, 1.0);\n        }\n    "}function s(){return"#version 300 es\n        precision mediump float;\n\n        uniform sampler2D uPos;\n        uniform sampler2D uVel;\n\n        uniform float uDelta;\n        uniform int uCount;\n\n        layout (location = 0) out vec4 outPos;\n        layout (location = 1) out vec4 outVel;\n\n        vec3 contain(vec3 pos);\n        vec3 oneForAll(vec3 pos, float p, inout float pred);\n        vec3 limit(vec3 v, float l);\n        float rand(vec2 co);\n\n        const float maxVel = 5.0;\n        const float maxAcc = 1.0;\n        const float bounds = 10.0;\n\n        const float range = 1.0;\n        const float aliScale = 1.5;\n        const float cohScale = 1.1;\n        const float sepScale = 1.3;\n        const float containScale = 0.3;\n\n        void main() {\n            vec4 temp = texelFetch(uPos, ivec2(gl_FragCoord), 0);\n            vec3 pos = temp.xyz;\n            vec3 vel = texelFetch(uVel, ivec2(gl_FragCoord), 0).xyz;\n\n            float aa = maxAcc + (maxAcc * maxAcc * temp.w);\n            float vv = maxVel + (maxVel * temp.w);\n\n            float pred = 0.0;\n\n            vec3 acc = contain(pos) + oneForAll(pos, temp.w, pred);\n            vel += limit(acc, aa + rand(pos.xy));\n            vel = limit(vel, vv);\n\n            pos += vel * uDelta;\n\n            outPos = vec4(pos, temp.w);\n            outVel = vec4(vel, pred);\n        }\n\n        vec3 contain(vec3 pos) {\n            vec3 dir = vec3(0.0) - pos;\n            float dist = length(dir);\n            if (dist > bounds) {\n                return normalize(vec3(dir)) * 0.5 * containScale;\n            }\n            return vec3(0.0);\n        }\n\n        vec3 oneForAll(vec3 pos, float p, inout float pred) {\n            int i;\n            int j = 0;\n\n            ivec2 boid;\n            vec4 boidPos;\n            vec3 dir;\n            float dist;\n\n            vec3 agg = vec3(0.0);\n            vec3 ali = vec3(0.0);\n            vec3 coh = vec3(0.0);\n            vec3 sep = vec3(0.0);\n            int c = 0;\n\n            float test = range + (range * p);\n            float test2 = range * 4.0;\n\n            for(j; j < uCount; j++) {\n                i = 0;\n                boid.y = j;\n                for(i; i < uCount; i++) {\n                    boid.x = i;\n                    boidPos = texelFetch(uPos, boid, 0);\n                    dir = pos - boidPos.xyz;\n                    dist = length(dir);\n                    if(dist > 0.00001 && dist < test) {\n                        ali += texelFetch(uVel, boid, 0).xyz;\n                        coh += boidPos.xyz;\n                        sep += dir;\n                        c++;\n                    }\n                    if(boidPos.w == 1.0 && dist > 0.00001 && dist < test2) {\n                        agg += dir;\n                        pred = dist / test2;\n                    }\n                }\n            }\n            if(c > 0) {\n                float cc = 1.0 / float(c);\n                agg += normalize(ali * cc) * aliScale;\n                agg += normalize((coh * cc) - pos) * cohScale;\n                agg += normalize(sep * cc) * sepScale;\n            }\n            return agg;\n        }\n\n        vec3 limit(vec3 v, float l) {\n            if(length(v) > l) {\n                v = normalize(v) * l;\n            }\n            return v;\n        }\n\n        float rand(vec2 co) {\n            return 0.5 - fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n        }\n    "}function v(){return"#version 300 es\n        precision mediump float;\n\n        layout (location = 0) in vec2 aTexIndex;\n        layout (location = 1) in vec3 aVerts;\n\n        uniform sampler2D uPos;\n        uniform sampler2D uVel;\n\n        uniform mat4 uLightSpaceMatrix;\n\n        mat4 lookAt(vec3 pos, vec3 target, vec3 up);\n        mat4 rotZ(float a);\n        mat4 scale(vec3 s);\n\n        void main() {\n            vec4 pos = vec4(texelFetch(uPos, ivec2(aTexIndex), 0).xyz, 1.0);\n            vec4 vel = vec4(texelFetch(uVel, ivec2(aTexIndex), 0).xyz, 1.0);\n\n            mat4 rot = lookAt(vec3(0.0), vel.xyz, vec3(0.0, 1.0, 0.0));\n            mat4 bank = rotZ(dot(vel.xz, vec2(0.0, 1.0)) * 0.2);\n\n            vec4 vert = rot * bank * vec4(aVerts, 1.0);\n\n            if (texelFetch(uPos, ivec2(aTexIndex), 0).w == 1.0) {\n                vert = scale(vec3(2.0)) * vert;\n            }\n\n            gl_Position = uLightSpaceMatrix * (vert + pos);\n        }\n\n        mat4 lookAt(vec3 pos, vec3 target, vec3 up) {\n            vec3 z = normalize(target - pos);\n            vec3 x = normalize(cross(up, z));\n            vec3 y = cross(z, x);\n\n            return mat4(\n                x.x, x.y, x.z, 0,\n                y.x, y.y, y.z, 0,\n                z.x, z.y, z.z, 0,\n                0,   0,   0,   1\n            );\n        }\n\n        mat4 rotZ(float a) {\n            float c = cos(a);\n            float s = sin(a);\n            return mat4(\n                c, -s, 0, 0,\n                s,  c, 0, 0,\n                0,  0, 1, 0,\n                0,  0, 0, 1\n            );\n        }\n\n        mat4 scale(vec3 s) {\n            return mat4 (\n                s.x, 0,   0,   0,\n                0,   s.y, 0,   0,\n                0,   0,   s.z, 0,\n                0,   0,   0,   1\n            );\n        }\n    "}function u(){return"#version 300 es\n        precision mediump float;\n\n        void main() {\n            gl_FragDepth = gl_FragCoord.z;\n        }\n    "}function m(n){for(var e=[],t=Math.pow(n,2),o=0;o<t;o++)o%800==0?e.push(20*(Math.random()-.5),20*(Math.random()-.5),20*(Math.random()-.5),1):e.push(20*(Math.random()-.5),20*(Math.random()-.5),20*(Math.random()-.5),0);return new Float32Array(e)}function p(n){for(var e=[],t=Math.pow(n,2),o=0;o<t;o++)e.push(Math.random()-.5,Math.random()-.5,Math.random()-.5,1);return new Float32Array(e)}function f(n){for(var e,t=[],o=0;o<n;o++)for(e=0;e<n;e++)t.push(e,o);return new Float32Array(t)}function d(){return new Float32Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0])}function h(){return new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,5,3,2,5,2,6,4,7,1,4,1,0,7,6,2,7,2,1,4,0,3,4,3,5])}function x(){for(var n=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-2,-1.5,-1,-2,1.5,-1,2,1.5,-1,2,-1.5,-1]),e=0;e<n.length;e++)e%3==2&&(n[e]*=8),2===Math.abs(n[e])&&(n[e]*=2),1.5===Math.abs(n[e])&&(n[e]*=1.5),n[e]*=.02;return n}function g(n,e,t){for(var o=2*Math.PI/e,a=[0,0,0],r=[],c=0;c<e;c++){var i=Math.sin(o*-c)*n,l=Math.cos(o*-c)*n;a.push(i,l,0),r.push(0,c+1,c+2)}return r.pop(),r.push(1),{indices:new Uint16Array(r),verts:new Float32Array(a)}}function y(e,t,o,a){for(var r=2*Math.PI/o,c=[],i=[],l=[],s=0;s<o;s++){c.push(0,0,0);var v=Math.sin(r*s)*e,u=Math.cos(r*s)*e*a;c.push(v,u,0),v=Math.sin(r*(s+1))*e,u=Math.cos(r*(s+1))*e*a,c.push(v,u,0),i.push(3*s,3*s+1,3*s+2);var m=9*s,p=Vec3.sub(new Vec3(c[m+3],c[m+4],c[m+5]),new Vec3(c[m],c[m+1],c[m+2])),f=Vec3.sub(new Vec3(c[m+6],c[m+7],c[m+8]),new Vec3(c[m],c[m+1],c[m+2])),d=Vec3.cross(p,f).normalise();l.push.apply(l,n(d.vec).concat(n(d.vec),n(d.vec)))}for(;s<2*o;s++){var h=Math.sin(r*s)*e,x=Math.cos(r*s)*e*a;c.push(h,x,0),c.push(0,0,t),h=Math.sin(r*(s+1))*e,x=Math.cos(r*(s+1))*e*a,c.push(h,x,0),i.push(3*s,3*s+1,3*s+2);var g=9*s,y=Vec3.sub(new Vec3(c[g+3],c[g+4],c[g+5]),new Vec3(c[g],c[g+1],c[g+2])),z=Vec3.sub(new Vec3(c[g+6],c[g+7],c[g+8]),new Vec3(c[g],c[g+1],c[g+2])),w=Vec3.cross(y,z).normalise();l.push.apply(l,n(w.vec).concat(n(w.vec),n(w.vec)))}return{indices:new Uint16Array(i),vertices:new Float32Array(c),normals:new Float32Array(l),count:i.length}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertexShaderSource=c,exports.fragmentShaderSource=i,exports.vertexShaderUpdate=l,exports.fragmentShaderUpdate=s,exports.vertexShaderShadow=v,exports.fragmentShaderShadow=u,exports.genPos=m,exports.genVel=p,exports.genIndex=f,exports.updateQuad=d,exports.boidIndices=h,exports.boidVertices=x,exports.disk=g,exports.cone=y;
},{}],"Obhd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("./Vec3")),e=s(require("./Mat4")),i=require("./sphereData"),r=require("./voronoiNoise"),a=require("./data");function s(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}var l=function(){function s(e){h(this,s),this.gl=e.getContext("webgl2"),null!==this.gl?(this.matrices={},this.stats={},this.camera={fov:60*Math.PI/180,ar:1,near:.1,far:100,pos:new t.default(0,0,20),target:new t.default(0,0,0)},this.light={dir:new t.default(-10,10,10)},this.shader={draw:{prog:null,loc:null},update:{prog:null,loc:null},shadow:{prog:null,loc:null}},this.vao={draw:null,update:null},this.vbo={draw:null,update:null,boidVerts:null,boidIndices:null,boidNormals:null},this.tbo={pos:[null,null],vel:[null,null],draw:null,shadow:null},this.fbo={update:[null,null],shadow:null},this.indx=1,this.cntSqrt=parseInt(window.location.hash.substr(1))||75,this.cnt=Math.pow(this.cntSqrt,2),this.geo=(0,i.createSphereGeo)(),this.tex=(0,r.voronoiPattern)(256,256),this.shadowMap={width:1024,height:1024}):console.log("Unable to initialize WebGl.")}return n(s,[{key:"init",value:function(){this.initStats(),this.initMouse(),this.initMatrices(),this.initGL(this.gl),this.initMaterial(this.gl),this.initGeometry(this.gl),this.initTextures(this.gl),this.initFrameBuffers(this.gl)}},{key:"update",value:function(){this.updateStats(),this.resizeCanvas(),this.updateCamera(),this.updateMatrices(),this.pause||this.updateFrameBuffer(),this.updateShadowMap(),this.draw()}},{key:"draw",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.frontFace(this.gl.CCW),this.gl.useProgram(this.shader.draw.prog),this.gl.uniformMatrix4fv(this.shader.draw.loc.uWorldViewProjection,!1,this.matrices.worldViewProjection.mat),this.gl.uniformMatrix4fv(this.shader.draw.loc.uWorld,!1,this.matrices.world.mat),this.gl.uniformMatrix4fv(this.shader.draw.loc.uNormal,!1,this.matrices.normal.mat),this.gl.uniformMatrix4fv(this.shader.draw.loc.uLightSpaceMatrix,!1,this.matrices.lightSpaceMatrix.mat),this.gl.uniform3fv(this.shader.draw.loc.uViewPos,this.camera.pos.vec),this.gl.bindVertexArray(this.vao.draw),this.gl.drawElementsInstanced(this.gl.TRIANGLES,this.geo.count,this.gl.UNSIGNED_SHORT,0,this.cnt)}},{key:"updateFrameBuffer",value:function(){this.indx=this.indx>0?0:1,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbo.update[this.indx]),this.gl.viewport(0,0,this.cntSqrt,this.cntSqrt),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.BLEND),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.tbo.pos[this.indx]),this.gl.activeTexture(this.gl.TEXTURE0+1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.tbo.vel[this.indx]),this.gl.useProgram(this.shader.update.prog),this.gl.uniform1f(this.shader.update.loc.uDelta,this.stats.delta),this.gl.bindVertexArray(this.vao.update),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}},{key:"updateShadowMap",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbo.shadow),this.gl.viewport(0,0,this.shadowMap.width,this.shadowMap.height),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.DEPTH_TEST),this.gl.clear(this.gl.DEPTH_BUFFER_BIT),this.gl.useProgram(this.shader.shadow.prog),this.gl.uniformMatrix4fv(this.shader.shadow.loc.uLightSpaceMatrix,!1,this.matrices.lightSpaceMatrix.mat),this.gl.bindVertexArray(this.vao.draw),this.gl.drawElementsInstanced(this.gl.TRIANGLES,this.geo.count,this.gl.UNSIGNED_SHORT,0,this.cnt)}},{key:"updateStats",value:function(){this.stats.now=performance.now(),this.stats.frames++,this.stats.delta=.001*(this.stats.now-this.stats.old),this.stats.delta=this.stats.delta>1?1:this.stats.delta,this.stats.now>=this.stats.nextInterval&&(this.stats.nextInterval=this.stats.now+this.stats.interval,this.stats.element.innerText=this.stats.frames+" : "+this.stats.delta.toFixed(3),this.stats.frames=0),this.stats.old=this.stats.now}},{key:"resizeCanvas",value:function(){this.gl.canvas.width===this.gl.canvas.clientWidth&&this.gl.canvas.height===this.gl.canvas.clientHeight||(this.gl.canvas.width=this.gl.canvas.clientWidth,this.gl.canvas.height=this.gl.canvas.clientHeight,this.camera.ar=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight)}},{key:"updateCamera",value:function(){if(this.camera.pos.z+=.1*this.mouseScroll,1===this.mouseButton)this.camera.pos.x+=-.05*this.mouseDiff[0],this.camera.pos.y+=.05*this.mouseDiff[1],this.camera.target.x+=-.05*this.mouseDiff[0],this.camera.target.y+=.05*this.mouseDiff[1];else if(0===this.mouseButton){var i=new t.default(this.mouseDiff[0],-this.mouseDiff[1],0),r=i.size();if(r>0){var a=new t.default(0,0,1).cross(i).transformMat4(e.default.invert(this.matrices.world).mat);this.matrices.world.rotate(.005*r,a.vec)}}this.mouseDiff=[0,0],this.mouseScroll=0}},{key:"updateMatrices",value:function(){this.matrices.projection.perspective(this.camera.fov,this.camera.ar,this.camera.near,this.camera.far),this.matrices.view.lookAt(this.camera.pos.vec,this.camera.target.vec,[0,1,0]).invert(),this.matrices.worldView=e.default.multiply(this.matrices.view,this.matrices.world),this.matrices.worldViewProjection=e.default.multiply(this.matrices.projection,this.matrices.worldView),this.matrices.normal=e.default.invert(this.matrices.world).transpose(),this.matrices.lightPorjection.orthographic(12,12,-12,-12,.01,32),this.matrices.lightView.lookAt(this.light.dir.vec,[0,0,0],[0,1,0]).invert(),this.matrices.lightSpaceMatrix=e.default.multiply(this.matrices.lightPorjection,e.default.multiply(this.matrices.lightView,this.matrices.world))}},{key:"initGL",value:function(t){t.clearColor(.8,.8,.8,1),t.clearDepth(1),t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.frontFace(t.CCW),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.getExtension("EXT_color_buffer_float")}},{key:"initStats",value:function(){this.stats.element=document.getElementById("fps"),this.stats.interval=1e3,this.stats.now=performance.now(),this.stats.old=this.stats.now,this.stats.nextInterval=this.stats.now+this.stats.interval,this.stats.frames=0,this.stats.delta=0}},{key:"initMatrices",value:function(){this.matrices={world:new e.default,view:new e.default,projection:new e.default,worldView:new e.default,worldViewProjection:new e.default,normal:new e.default,lightView:new e.default,lightPorjection:new e.default,lightSpaceMatrix:new e.default}}},{key:"initMaterial",value:function(t){var e=this.initShader(t,t.VERTEX_SHADER,(0,a.vertexShaderSource)()),i=this.initShader(t,t.FRAGMENT_SHADER,(0,a.fragmentShaderSource)());this.shader.draw.prog=this.initProgram(t,e,i),this.shader.draw.loc={uWorldViewProjection:t.getUniformLocation(this.shader.draw.prog,"uWorldViewProjection"),uPos:t.getUniformLocation(this.shader.draw.prog,"uPos"),uVel:t.getUniformLocation(this.shader.draw.prog,"uVel"),uWorld:t.getUniformLocation(this.shader.draw.prog,"uWorld"),uNormal:t.getUniformLocation(this.shader.draw.prog,"uNormal"),uLightSpaceMatrix:t.getUniformLocation(this.shader.draw.prog,"uLightSpaceMatrix"),uViewPos:t.getUniformLocation(this.shader.draw.prog,"uViewPos"),uTexture:t.getUniformLocation(this.shader.draw.prog,"uTexture"),uShadow:t.getUniformLocation(this.shader.draw.prog,"uShadow")},this.gl.useProgram(this.shader.draw.prog),this.gl.uniform1i(this.shader.draw.loc.uPos,0),this.gl.uniform1i(this.shader.draw.loc.uVel,1),this.gl.uniform1i(this.shader.draw.loc.uTexture,2),this.gl.uniform1i(this.shader.draw.loc.uShadow,3),e=this.initShader(t,t.VERTEX_SHADER,(0,a.vertexShaderUpdate)()),i=this.initShader(t,t.FRAGMENT_SHADER,(0,a.fragmentShaderUpdate)()),this.shader.update.prog=this.initProgram(t,e,i),this.shader.update.loc={uPos:t.getUniformLocation(this.shader.update.prog,"uPos"),uVel:t.getUniformLocation(this.shader.update.prog,"uVel"),uDelta:t.getUniformLocation(this.shader.update.prog,"uDelta"),uCount:t.getUniformLocation(this.shader.update.prog,"uCount")},this.gl.useProgram(this.shader.update.prog),this.gl.uniform1i(this.shader.update.loc.uPos,0),this.gl.uniform1i(this.shader.update.loc.uVel,1),this.gl.uniform1i(this.shader.update.loc.uCount,this.cntSqrt),e=this.initShader(t,t.VERTEX_SHADER,(0,a.vertexShaderShadow)()),i=this.initShader(t,t.FRAGMENT_SHADER,(0,a.fragmentShaderShadow)()),this.shader.shadow.prog=this.initProgram(t,e,i),this.shader.shadow.loc={uLightSpaceMatrix:t.getUniformLocation(this.shader.shadow.prog,"uLightSpaceMatrix"),uPos:t.getUniformLocation(this.shader.shadow.prog,"uPos"),uVel:t.getUniformLocation(this.shader.shadow.prog,"uVel")},this.gl.useProgram(this.shader.shadow.prog),this.gl.uniform1i(this.shader.shadow.loc.uPos,0),this.gl.uniform1i(this.shader.shadow.loc.uVel,1),this.gl.useProgram(null)}},{key:"initGeometry",value:function(t){this.vbo.draw=t.createBuffer(),this.vao.draw=t.createVertexArray(),t.bindVertexArray(this.vao.draw),t.bindBuffer(t.ARRAY_BUFFER,this.vbo.draw),t.bufferData(t.ARRAY_BUFFER,(0,a.genIndex)(this.cntSqrt),t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0),t.vertexAttribDivisor(0,1),this.vbo.boidIndices=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vbo.boidIndices),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.geo.indices,t.STATIC_DRAW),this.vbo.boidVerts=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vbo.boidVerts),t.bufferData(t.ARRAY_BUFFER,this.geo.vertices,t.STATIC_DRAW),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,3,t.FLOAT,!1,0,0),this.vbo.boidNormals=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vbo.boidNormals),t.bufferData(t.ARRAY_BUFFER,this.geo.normals,t.STATIC_DRAW),t.enableVertexAttribArray(2),t.vertexAttribPointer(2,3,t.FLOAT,!1,0,0),this.vbo.boidUvs=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vbo.boidUvs),t.bufferData(t.ARRAY_BUFFER,this.geo.uvs,t.STATIC_DRAW),t.enableVertexAttribArray(3),t.vertexAttribPointer(3,2,t.FLOAT,!1,0,0),this.vbo.update=t.createBuffer(),this.vao.update=t.createVertexArray(),t.bindVertexArray(this.vao.update),t.bindBuffer(t.ARRAY_BUFFER,this.vbo.update),t.bufferData(t.ARRAY_BUFFER,(0,a.updateQuad)(),t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,0,0),t.bindVertexArray(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},{key:"initTextures",value:function(t){this.tbo.pos[0]=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tbo.pos[0]),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.cntSqrt,this.cntSqrt,0,t.RGBA,t.FLOAT,(0,a.genPos)(this.cntSqrt)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.tbo.pos[1]=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tbo.pos[1]),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.cntSqrt,this.cntSqrt,0,t.RGBA,t.FLOAT,(0,a.genPos)(this.cntSqrt)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.tbo.vel[0]=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tbo.vel[0]),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.cntSqrt,this.cntSqrt,0,t.RGBA,t.FLOAT,(0,a.genVel)(this.cntSqrt)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.tbo.vel[1]=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tbo.vel[1]),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.cntSqrt,this.cntSqrt,0,t.RGBA,t.FLOAT,(0,a.genVel)(this.cntSqrt)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.tbo.draw=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tbo.draw),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.tex.width,this.tex.height,0,t.RGBA,t.UNSIGNED_BYTE,this.tex.image),t.generateMipmap(t.TEXTURE_2D),this.tbo.shadow=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.tbo.shadow),t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT32F,this.shadowMap.width,this.shadowMap.height,0,t.DEPTH_COMPONENT,t.FLOAT,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0+2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.tbo.draw),this.gl.activeTexture(this.gl.TEXTURE0+3),this.gl.bindTexture(this.gl.TEXTURE_2D,this.tbo.shadow)}},{key:"initFrameBuffers",value:function(t){this.fbo.update[0]=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.fbo.update[0]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.tbo.pos[1],0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,t.TEXTURE_2D,this.tbo.vel[1],0),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.log("Unable to create frame buffer"),this.fbo.update[1]=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.fbo.update[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.tbo.pos[0],0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,t.TEXTURE_2D,this.tbo.vel[0],0),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.log("Unable to create frame buffer"),this.fbo.shadow=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.fbo.shadow),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.tbo.shadow,0),t.drawBuffers([t.NONE]),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.log("Unable to create frame buffer"),t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"initProgram",value:function(t,e,i,r){var a=t.createProgram();return t.attachShader(a,e),t.deleteShader(e),t.attachShader(a,i),t.deleteShader(i),r&&t.transformFeedbackVaryings(a,r,t.SEPARATE_ATTRIBS),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)?a:(console.log("Unable to initialize the shader program:\n"+t.getProgramInfoLog(a)),t.deleteProgram(a),null)}},{key:"initShader",value:function(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.log("An error occurred compiling the shaders:\n"+t.getShaderInfoLog(r)),t.deleteShader(r),null)}},{key:"cleanUp",value:function(t){this.gl.useProgram(null),t.deleteProgram(this.shader.draw.prog),t.deleteProgram(this.shader.update.prog),t.deleteProgram(this.shader.update.visualize),t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(this.tbo.pos[0]),t.deleteTexture(this.tbo.pos[1]),t.deleteTexture(this.tbo.vel[0]),t.deleteTexture(this.tbo.vel[1]),t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(this.vbo.draw),t.deleteBuffer(this.vbo.update),t.deleteBuffer(this.vbo.boidIndices),t.deleteBuffer(this.vbo.boidVerts),t.bindVertexArray(null),t.deleteVertexArray(this.vao.draw[0]),t.deleteVertexArray(this.vao.draw[1]),t.deleteVertexArray(this.vao.update[0]),t.deleteVertexArray(this.vao.update[1]),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.fbo.update[0]),t.deleteFramebuffer(this.fbo.update[1])}},{key:"initMouse",value:function(){var t=this;function e(a){a.preventDefault(),t.gl.canvas.addEventListener("mousemove",i),window.addEventListener("mouseup",r),t.gl.canvas.removeEventListener("mousedown",e)}function i(e){e.preventDefault(),t.mouseDiff=[e.movementX,e.movementY],t.mouseButton=e.button}function r(a){a.preventDefault(),t.gl.canvas.addEventListener("mousedown",e),t.gl.canvas.removeEventListener("mousemove",i),window.removeEventListener("mouseup",r)}this.mouseDiff=[0,0],this.mouseScroll=0,this.pause=!1,this.gl.canvas.addEventListener("mousedown",e),this.gl.canvas.addEventListener("wheel",function(e){e.preventDefault(),t.mouseScroll=e.deltaY}),document.addEventListener("keypress",function(e){32==e.which&&(t.pause=!t.pause)})}}],[{key:"run",value:function(t){var e=new s(t);return e.init(),requestAnimationFrame(function t(){e.update(),requestAnimationFrame(t)}),e}}]),s}();exports.default=l;
},{"./Vec3":"Xu3H","./Mat4":"og34","./sphereData":"LO0M","./voronoiNoise":"hAMr","./data":"RkSw"}],"mpVp":[function(require,module,exports) {
"use strict";var e=t(require("./scripts/WebGL"));function t(e){return e&&e.__esModule?e:{default:e}}function n(){var t=document.getElementById("webGL");e.default.run(t)}document.addEventListener("DOMContentLoaded",n);
},{"./scripts/WebGL":"Obhd"}]},{},["mpVp"], null)
//# sourceMappingURL=/script.b5360c61.js.map